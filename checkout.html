<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 font-sans min-h-screen flex flex-col">
    <!-- Header -->
    <header class="bg-blue-600 text-white p-4 shadow-md">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold">My E-Commerce Store</h1>
            <nav class="text-lg font-semibold flex items-center">
                <a href="index.html" class="text-white hover:text-yellow-300 mx-4">Home</a>
                <a href="products.html" class="text-white hover:text-yellow-300 mx-4">Products</a>
                <a href="about.html" class="text-white hover:text-yellow-300 mx-4">About</a>
                <a href="contact.html" class="text-white hover:text-yellow-300 mx-4">Contact</a>
            </nav>
        </div>
    </header>
    
    <!-- Checkout Section -->
    <section class="py-16 flex-grow">
        <div class="container mx-auto px-4">
            <div class="flex flex-col lg:flex-row">
                <!-- Product Details -->
                <div class="lg:w-1/2 bg-white p-6 rounded-lg shadow-md">
                    <h2 class="text-2xl font-bold mb-4">Product Details</h2>
                    <div id="checkoutProductDetails" class="flex flex-col items-center lg:items-start">
                        <!-- Product details will be populated here -->
                    </div>
                </div>
                
                <!-- Payment Details -->
                <div class="lg:w-1/2 lg:pl-8 mt-8 lg:mt-0">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h2 class="text-2xl font-bold mb-4">Payment Details</h2>
                        <form id="paymentForm" class="space-y-4">
                            <!-- Full Name Field -->
                            <div>
                                <label for="full_name" class="block text-gray-700 font-semibold mb-2">Full Name (as displayed on card)</label>
                                <input type="text" id="full_name" class="w-full border border-gray-300 rounded-lg p-3 shadow-sm focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition duration-200" placeholder="Your Name" required>
                                <p class="text-red-500 text-sm hidden" id="nameError">Name is required.</p>
                            </div>
                            
                            <!-- Card Number Field -->
                            <div>
                                <label for="card-number-input" class="block text-gray-700 font-semibold mb-2">Card Number</label>
                                <input type="text" id="card-number-input" class="w-full border border-gray-300 rounded-lg p-3 shadow-sm focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition duration-200" placeholder="xxxx-xxxx-xxxx-xxxx" maxlength="19" required>
                                <p class="text-red-500 text-sm hidden" id="cardNumberError">Please enter a valid card number.</p>
                            </div>

                            <!-- Expiry Date and CVV -->
                            <div class="flex space-x-4">
                                <div class="w-1/2">
                                    <label for="card-expiration-input" class="block text-gray-700 font-semibold mb-2">Expiry Date (MM/YY)</label>
                                    <input type="text" id="card-expiration-input" maxlength="5" class="w-full border border-gray-300 rounded-lg p-3 shadow-sm focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition duration-200" placeholder="MM/YY" required>
                                    <p class="text-red-500 text-sm hidden" id="expiryDateError">Invalid expiry date. It must be a future date.</p>
                                </div>
                                
                                <div class="w-1/2">
                                    <label for="cvv" class="block text-gray-700 font-semibold mb-2">CVV</label>
                                    <input type="text" id="cvv" class="w-full border border-gray-300 rounded-lg p-3 shadow-sm focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition duration-200" placeholder="123" maxlength="3" required>
                                    <p class="text-red-500 text-sm hidden" id="cvvError">CVV must be exactly 3 digits.</p>
                                </div>
                            </div>

                            <!-- Billing Address Field -->
                            <div>
                                <label for="address" class="block text-gray-700 font-semibold mb-2">Billing Address</label>
                                <input type="text" id="address" class="w-full border border-gray-300 rounded-lg p-3 shadow-sm focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition duration-200" placeholder="1234 Main St" required>
                                <p class="text-red-500 text-sm hidden" id="addressError">Address is required.</p>
                            </div>
                            
                            <!-- Pay Button -->
                            <button type="submit" class="bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-500 transition duration-300 ease-in-out w-full">Pay Now</button>
                        </form>
                        
                        <!-- Total Amount -->
                        <p id="totalAmount" class="mt-4 text-lg font-semibold">Total: â‚¹0.00</p>
                        
                        <!-- Success Message -->
                        <div id="paymentSuccessMessage" class="hidden mt-6 p-4 bg-green-100 border border-green-400 text-green-700 rounded">
                            Payment successful! Thank you for your purchase.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-blue-600 text-white py-4">
        <div class="container mx-auto text-center">
            <p>&copy; 2024 My E-Commerce Store. All rights reserved.</p>
        </div>
    </footer>

    <!-- JavaScript to Handle Payment and Validation -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const checkoutProductDetails = document.getElementById('checkoutProductDetails');
            const totalAmountElement = document.getElementById('totalAmount');
            const paymentSuccessMessage = document.getElementById('paymentSuccessMessage');
            
            // Retrieve product details from localStorage
            const productName = localStorage.getItem('productName');
            const productDetail = localStorage.getItem('productDetail');
            const productPrice = localStorage.getItem('productPrice');
            const productDescription = localStorage.getItem('productDescription');
            const productImages = JSON.parse(localStorage.getItem('productImages'));
    
            // Populate product details
            checkoutProductDetails.innerHTML = `
                <img src="${productImages[0]}" alt="Product Image" class="w-full h-64 object-contain mb-4 rounded-md shadow-md">
                <h3 class="text-xl font-semibold mb-2">${productName}</h3>
                <p class="mb-2">${productDetail}</p>
                <p class="font-semibold mb-4">${productPrice}</p>
                <p>${productDescription}</p>
            `;
    
            // Update the total amount
            totalAmountElement.textContent = `Total: ${productPrice}`;
    
            // Real-time validation
            const fullName = document.getElementById('full_name');
            const cardNumber = document.getElementById('card-number-input');
            const expiryDate = document.getElementById('card-expiration-input');
            const cvv = document.getElementById('cvv');
            const address = document.getElementById('address');
    
            fullName.addEventListener('input', () => {
                document.getElementById('nameError').classList.toggle('hidden', fullName.value.trim() !== '');
            });
    
            cardNumber.addEventListener('input', () => {
                cardNumber.value = cardNumber.value.replace(/\D/g, '').replace(/(\d{4})(?=\d)/g, '$1-'); // Format as xxxx-xxxx-xxxx-xxxx
                const cardNumberValid = /^\d{4}-\d{4}-\d{4}-\d{4}$/.test(cardNumber.value);
                document.getElementById('cardNumberError').classList.toggle('hidden', cardNumberValid);
            });
    
            expiryDate.addEventListener('input', () => {
                expiryDate.value = expiryDate.value.replace(/\D/g, '').replace(/(\d{2})(\d{2})/, '$1/$2'); // Format as MM/YY
                const expiryDateValid = /^(0[1-9]|1[0-2])\/[0-9]{2}$/.test(expiryDate.value);
                document.getElementById('expiryDateError').classList.toggle('hidden', expiryDateValid);
            });
    
            cvv.addEventListener('input', () => {
                cvv.value = cvv.value.replace(/\D/g, ''); // Only allow digits
                const cvvValid = /^\d{3}$/.test(cvv.value);
                document.getElementById('cvvError').classList.toggle('hidden', cvvValid);
            });
    
            address.addEventListener('input', () => {
                document.getElementById('addressError').classList.toggle('hidden', address.value.trim() !== '');
            });
    
            // Payment form submission
            document.getElementById('paymentForm').addEventListener('submit', function(event) {
                event.preventDefault();
    
                // Check if all fields are valid
                if (
                    fullName.value.trim() !== '' &&
                    /^\d{4}-\d{4}-\d{4}-\d{4}$/.test(cardNumber.value) &&
                    /^(0[1-9]|1[0-2])\/[0-9]{2}$/.test(expiryDate.value) &&
                    /^\d{3}$/.test(cvv.value) &&
                    address.value.trim() !== ''
                ) {
                    // Hide the form and display success message
                    this.style.display = 'none';
                    paymentSuccessMessage.classList.remove('hidden');
                } else {
                    // Show appropriate error messages
                    if (fullName.value.trim() === '') {
                        document.getElementById('nameError').classList.remove('hidden');
                    }
                    if (!/^\d{4}-\d{4}-\d{4}-\d{4}$/.test(cardNumber.value)) {
                        document.getElementById('cardNumberError').classList.remove('hidden');
                    }
                    if (!/^(0[1-9]|1[0-2])\/[0-9]{2}$/.test(expiryDate.value)) {
                        document.getElementById('expiryDateError').classList.remove('hidden');
                    }
                    if (!/^\d{3}$/.test(cvv.value)) {
                        document.getElementById('cvvError').classList.remove('hidden');
                    }
                    if (address.value.trim() === '') {
                        document.getElementById('addressError').classList.remove('hidden');
                    }
                }
            });
        });
    </script>
</body>
</html>
